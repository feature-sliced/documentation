---
sidebar_position: 4
title: APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‡¦ç†
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import TranslationBanner from "@site/src/shared/ui/translation-banner/tmpl.mdx"

<TranslationBanner />

# APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‡¦ç† {#handling-api-requests}

## å…±æœ‰APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ {#shared-api-requests}

å…±é€šã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚¸ãƒƒã‚¯ã¯`shared/api`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç°¡å˜ã«å†åˆ©ç”¨ã§ãã€ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã®é«˜é€ŸåŒ–ã«å½¹ç«‹ã¡ã¾ã™ã€‚å¤šãã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€APIå‘¼ã³å‡ºã—ã«å¿…è¦ãªã®ã¯ã“ã‚Œã ã‘ã§ã™ã€‚

å…¸å‹çš„ãªãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
- ğŸ“‚ shared
    - ğŸ“‚ api
        - ğŸ“„ client.ts
        - ğŸ“„ index.ts
        - ğŸ“‚ endpoints
            - ğŸ“„ login.ts

`client.ts`ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã®è¨­å®šã‚’ä¸€å…ƒåŒ–ã—ã¾ã™ã€‚é¸æŠã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆ`fetch()`ã‚„`axios`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãªã©ï¼‰ã‚’ãƒ©ãƒƒãƒ—ã—ã€æ¬¡ã®ã‚ˆã†ãªå…±é€šã®è¨­å®šã‚’å‡¦ç†ã—ã¾ã™ã€‚

- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒ™ãƒ¼ã‚¹URL
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆèªè¨¼ç”¨ãªã©ï¼‰
- ãƒ‡ãƒ¼ã‚¿ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

`axios`ã¨`fetch`ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚

<Tabs>

<TabItem value="axios" label="Axios">
```ts title="shared/api/client.ts"
// Example using axios
import axios from 'axios';

export const client = axios.create({
  baseURL: 'https://your-api-domain.com/api/',
  timeout: 5000,
  headers: { 'X-Custom-Header': 'my-custom-value' }
});
```
</TabItem>

<TabItem value="fetch" label="Fetch">
```ts title="shared/api/client.ts"
export const client = {
  async post(endpoint: string, body: any, options?: RequestInit) {
    const response = await fetch(`https://your-api-domain.com/api${endpoint}`, {
      method: 'POST',
      body: JSON.stringify(body),
      ...options,
      headers: {
        'Content-Type': 'application/json',
        'X-Custom-Header': 'my-custom-value',
        ...options?.headers,
      },
    });
    return response.json();
  }
  // ... other methods like put, delete, etc.
};
```
</TabItem>

</Tabs>

å€‹ã€…ã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆé–¢æ•°ã¯`shared/api/endpoints`ã«ã€APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã¦æ•´ç†ã—ã¾ã™ã€‚

:::note

ä¾‹ã‚’ã‚ã‹ã‚Šã‚„ã™ãã™ã‚‹ãŸã‚ã«ã€ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯çœç•¥ã—ã¦ã„ã¾ã™ã€‚Zodã‚„Valibotã®ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€[Type Validation and Schemas](/docs/guides/examples/types#type-validation-schemas-and-zod)ã®è¨˜äº‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

:::

```ts title="shared/api/endpoints/login.ts"
import { client } from '../client';

export interface LoginCredentials {
  email: string;
  password: string;
}

export function login(credentials: LoginCredentials) {
  return client.post('/login', credentials);
}
```

`shared/api`ã®`index.ts`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆé–¢æ•°ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

```ts title="shared/api/index.ts"
export { client } from './client'; // If you want to export the client itself
export { login } from './endpoints/login';
export type { LoginCredentials } from './endpoints/login';
```

## ã‚¹ãƒ©ã‚¤ã‚¹å›ºæœ‰ã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ {#slice-specific-api-requests}

APIãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒç‰¹å®šã®ã‚¹ãƒ©ã‚¤ã‚¹ï¼ˆå˜ä¸€ã®ãƒšãƒ¼ã‚¸ã‚„æ©Ÿèƒ½ãªã©ï¼‰ã§ã®ã¿ä½¿ç”¨ã•ã‚Œã€å†åˆ©ç”¨ã•ã‚Œãªã„å ´åˆã¯ã€ãã®ã‚¹ãƒ©ã‚¤ã‚¹ã®apiã‚»ã‚°ãƒ¡ãƒ³ãƒˆã«é…ç½®ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¹ãƒ©ã‚¤ã‚¹å›ºæœ‰ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒãã¡ã‚“ã¨æ•´ç†ã•ã‚Œã¾ã™ã€‚

- ğŸ“‚ pages
    - ğŸ“‚ login
        - ğŸ“„ index.ts
        - ğŸ“‚ api
            - ğŸ“„ login.ts
        - ğŸ“‚ ui
            - ğŸ“„ LoginPage.tsx

```ts title="pages/login/api/login.ts"
import { client } from 'shared/api';

interface LoginCredentials {
  email: string;
  password: string;
}

export function login(credentials: LoginCredentials) {
  return client.post('/login', credentials);
}
```

ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä»–ã®å ´æ‰€ã§å¿…è¦ã«ãªã‚‹å¯èƒ½æ€§ã¯ä½ã„ã®ã§ã€ãƒšãƒ¼ã‚¸ã®å…¬é–‹APIã§`login()`é–¢æ•°ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

:::note

APIå‘¼ã³å‡ºã—ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å‹ã‚’`entities`ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«æ™‚æœŸå°šæ—©ã«é…ç½®ã™ã‚‹ã“ã¨ã¯é¿ã‘ã¦ãã ã•ã„ã€‚ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãŒå¿…è¦ã¨ã™ã‚‹ã‚‚ã®ã¨ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚`shared/api`ã¾ãŸã¯ã‚¹ãƒ©ã‚¤ã‚¹ã®`api`ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®APIãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿ã‚’é©åˆ‡ã«å¤‰æ›ã§ãã€ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®æ‡¸å¿µäº‹é …ã«é›†ä¸­ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

:::

## ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã®ä½¿ç”¨ {#client-generators}

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«OpenAPIä»•æ§˜ãŒã‚ã‚‹å ´åˆã€[orval](https://orval.dev/)ã‚„[openapi-typescript](https://openapi-ts.dev/)ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã§APIã®å‹ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆé–¢æ•°ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã¯ã€ãŸã¨ãˆã°`shared/api/openapi`ã«é…ç½®ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®å‹ãŒä½•ã§ã‚ã‚‹ã‹ã€ãã—ã¦ãã‚Œã‚‰ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã‚’æ–‡æ›¸åŒ–ã™ã‚‹ãŸã‚ã«ã€`README.md`ã‚’å«ã‚ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

## ã‚µãƒ¼ãƒãƒ¼ã‚¹ãƒ†ãƒ¼ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã®çµ±åˆ {#server-state-libraries}

[TanStack Query (React Query)](https://tanstack.com/query/latest)ã‚„[Pinia Colada](https://pinia-colada.esm.dev/)ã®ã‚ˆã†ãªã‚µãƒ¼ãƒãƒ¼ã‚¹ãƒ†ãƒ¼ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ã‚¹ãƒ©ã‚¤ã‚¹é–“ã§å‹ã‚„ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã‚’å…±æœ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚æ¬¡ã®ã‚ˆã†ãªã‚‚ã®ã«ã¯`shared`ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

- APIãƒ‡ãƒ¼ã‚¿å‹
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼
- å…±é€šã®ã‚¯ã‚¨ãƒª/ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³
